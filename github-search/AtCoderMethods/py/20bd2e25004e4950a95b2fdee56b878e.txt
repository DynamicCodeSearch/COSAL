def F(D,N,X=1):Z=N and F(D*D%M,N//2,(X*D+X)%M);return[Z,Z*D+X][N%2]